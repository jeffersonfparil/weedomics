# 1. What is the current pattern of herbicide resistances across SE Australia?

## 1.1. Models of herbicide resistances across SE Australia using geographic coordinates

Plot levels of herbicide resistance across the landscape, model the distribution of resistances across the landscape, and assess the significance of longitude, latitude, and longitude-by-latitude effects.

This will serve as our null model against which subsequent models will compared to.

```R
source("/data-weedomics-1/weedomics/glyphosate_resistance_seau/src/kriging_and_maps.r")
setwd("/data-weedomics-1/weedomics/exploratory/res")
fname_region_kml = "landscape.kml"
fname_phenotype = "phenotype_data.csv"
phenotypes = read.csv(fname_phenotype)
phenotypes = phenotypes[!is.na(phenotypes$Longitude), ]
phenotypes = phenotypes[!is.na(phenotypes$Latitude), ]
x_limit = range(phenotypes$Longitude)
y_limit = range(phenotypes$Latitude)
idx_herbicide_columns = which(!grepl("Population", colnames(phenotypes)) & 
                              !grepl("Pool", colnames(phenotypes)) &
                              !grepl("Batch", colnames(phenotypes)) &
                              !grepl("Latitude", colnames(phenotypes)) &
                              !grepl("Longitude", colnames(phenotypes)))
vec_herbicides = colnames(phenotypes)[idx_herbicide_columns]

colours = list(rdylgn=rev(c("#A50026","#D73027","#F46D43","#FDAE61","#FEE08B","#FFFFBF","#D9EF8B","#A6D96A","#66BD63","#1A9850","#006837")),
            spectral=rev(c("#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2")),
            rdpu=c("#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"))
n_colours = 101

### Let's plot the herbicide resistance distributions
summary_mod = list()
var_pheno = list()
for (herbi in vec_herbicides) {
    # herbi = vec_herbicides[3]
    print("#############################################")
    print(herbi)
    REGION = LOAD_AND_DEFINE_REGION(fname_region_kml=fname_region_kml, fname_phenotype=fname_phenotype, herbicide=herbi, n_point_samples=1e4)
    MODELS = KRIGING_AND_LINEAR_MODELS(REGION)
    eval(parse(text=paste0("summary_mod$`", herbi, "` = MODELS$summary_mod")))
    eval(parse(text=paste0("var_pheno$`", herbi, "` = MODELS$var_pheno")))
    # fname_map_svg_unscaled = paste0(herbi, "_autokrige_unscaled.svg")
    fname_map_svg_gradient = paste0(herbi, "_autokrige.svg")
    # fname_svg = PLOT_DISTRIBUTION_MAP(REGION=REGION, MODELS=MODELS, x_limit=x_limit, y_limit=y_limit, fname_map_svg=fname_map_svg_unscaled, colours=colours[[1]], n_colours=n_colours, plot_points=TRUE, plot_krig=TRUE, rescale_krig=FALSE, hist_not_range=TRUE, label="Resistance (%)")
    fname_svg = PLOT_DISTRIBUTION_MAP(REGION=REGION, MODELS=MODELS, x_limit=x_limit, y_limit=y_limit, fname_map_svg=fname_map_svg_gradient, colours=colours[[3]], point_colours=colours[[1]], n_colours=n_colours, plot_points=TRUE, plot_krig=TRUE, rescale_krig=TRUE, hist_not_range=FALSE, label="Mean Extrapolated Resistance (%)")
}

### Let us define multiple resistance phenotype where we set populations as resistant if the survival level is above 20% (See Alex's notes above dated 2024/02/02 for details)
mat_R = phenotypes[, idx_herbicide_columns] > 20
mat_R[is.na(mat_R)] = 0 ### Set missing to zero as we want to convert multiple resistance rates back to the actual number of herbicides each population is resistant to
vec_R = rowMeans(mat_R, na.rm=TRUE)
phenotypes$Multiple_resistance = vec_R
vec_herbicides = c(vec_herbicides, "Multiple_resistance")
fname_phenotype = gsub(".csv", "-with_Multiple_resistance.csv", fname_phenotype)
write.table(phenotypes, file=fname_phenotype, sep=",", quote=FALSE, row.names=FALSE, col.names=TRUE)
herbi = "Multiple_resistance"
REGION = LOAD_AND_DEFINE_REGION(fname_region_kml=fname_region_kml, fname_phenotype=fname_phenotype, herbicide=herbi, n_point_samples=1e4)
MODELS = KRIGING_AND_LINEAR_MODELS(REGION)
fname_map_svg_gradient = paste0(herbi, "_autokrige.svg")
fname_svg = PLOT_DISTRIBUTION_MAP(REGION=REGION, MODELS=MODELS, x_limit=x_limit, y_limit=y_limit, fname_map_svg=fname_map_svg_gradient, colours=colours[[3]], point_colours=colours[[1]], n_colours=n_colours, plot_points=FALSE, plot_krig=TRUE, rescale_krig=TRUE, hist_not_range=FALSE,
    label=paste0("Mean Extrapolated Multiple Resistance (%)\nObserved number of resistances per population\nmean=", 
        round(median(vec_R*ncol(mat_R)),2),
        "; median=", 
        median(vec_R*ncol(mat_R)),
        "; min=", 
        min(vec_R*ncol(mat_R)),
        "; max=", 
        max(vec_R*ncol(mat_R))
    ))
print(MODELS)

```

![Tri_Allate_autokrige](../res/Tri_Allate_autokrige.svg)
![Glyphosate_autokrige](../res/Glyphosate_autokrige.svg)
![Prosulfocarb_and_S_metolachlor_autokrige](../res/Prosulfocarb_and_S_metolachlor_autokrige.svg)
![Clethodim_autokrige](../res/Clethodim_autokrige.svg)
![Pyroxasulfone_autokrige](../res/Pyroxasulfone_autokrige.svg)
![Imazamox_and_Imazapyr_autokrige](../res/Imazamox_and_Imazapyr_autokrige.svg)
![Bixlozone_autokrige](../res/Bixlozone_autokrige.svg)
![Atrazine_autokrige](../res/Atrazine_autokrige.svg)
![Cinmethylin_autokrige](../res/Cinmethylin_autokrige.svg)
![Paraquat_autokrige](../res/Paraquat_autokrige.svg)
![Sulfometuron_autokrige](../res/Sulfometuron_autokrige.svg)
![Terbuthylazine_autokrige](../res/Terbuthylazine_autokrige.svg)
![Multiple_resistance_autokrige](../res/Multiple_resistance_autokrige.svg)

## Findings

There is some significant geographic gradient as we move from north to south in terms of resistance to:

- **glyphosate**
- **clethodim**
- **tri-allate (Avadex)**.

This suggests possible migration effects and that one or few population/s is/are the source/s of resistance alleles. Also, the movement of seeds and farming equipment may facilitating the migration of weed seeds harbouring resistances as harvesting time moves from north to the wetter southern areas.

Some significant position (lat x lon interaction) effects for bixlozone resistance. While the rest of the resistance traits do not exhibit any significant geographical distribution effects. This probably means that these herbicide resisitances is not spreading from a single or few source population, but rather evolving independently from either standing genetic variation (as affected by founder effects) and *de novo* mutation (as affected by population size).
